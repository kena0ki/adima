<!DOCTYPE html>
<html>

<head>
  <meta name="viewport" 
        content="width=device-width, 
        initial-scale=1.0, 
        user-scalable=no" />
  <title>Drag/Drop/Bounce</title>
  <style>
    #container {
      width: 100%;
      height: 400px;
      background-color: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border-radius: 7px;
      touch-action: none;
    }
    #item {
      width: 100px;
      height: 100px;
      background-color: rgb(245, 230, 99);
      border: 10px solid rgba(136, 136, 136, .5);
      border-radius: 50%;
      touch-action: none;
      user-select: none;
    }
    #item:active {
      background-color: rgba(168, 218, 220, 1.00);
    }
    #item:hover {
      cursor: pointer;
      border-width: 20px;
    }
  </style>
</head>

<body>

  <div id="outerContainer">
    <div id="container">
      <div id="item">

      </div>
    </div>
  </div>
  <svg id="svg-container">
    <rect width="100%" height="100%" fill="green" stroke="green" />
    <circle id="svg-dragee" cx="40" cy="40" r="20" fill="grey" stroke="grey" ></circle>
  </svg>
  <svg id="svg-container2">
    <rect width="100%" height="100%" fill="blue" stroke="blue" />
    <circle id="svg-dragee2" cx="40" cy="40" r="20" fill="grey" stroke="grey" ></circle>
  </svg>
  <script>
    const svg = document.getElementById('svg-dragee2');
    draggablify(svg);
    function draggablify(elm) {
        elm.addEventListener('mousedown', dragStart);
        elm.addEventListener('touchstart', dragStart);
        var offsetX = 0, offsetY = 0;
        function dragStart(strtEvt) {
            console.log('dragStart:', strtEvt);
            if (strtEvt instanceof MouseEvent && strtEvt.button !== 0)
                return;
            var initialPointX = (strtEvt instanceof MouseEvent ? strtEvt.clientX : strtEvt.touches[0].clientX) - offsetX;
            var initialPointY = (strtEvt instanceof MouseEvent ? strtEvt.clientY : strtEvt.touches[0].clientY) - offsetY;
            document.addEventListener('mousemove', dragging);
            document.addEventListener('touchmove', dragging);
            function dragging(mvEvt) {
                console.log('dragging:', mvEvt);
                mvEvt.preventDefault();
                var diffX = (mvEvt instanceof MouseEvent ? mvEvt.clientX : mvEvt.touches[0].clientX) - initialPointX;
                var diffY = (mvEvt instanceof MouseEvent ? mvEvt.clientY : mvEvt.touches[0].clientY) - initialPointY;
                console.log('initial:', initialPointX, initialPointY);
                console.log('diff:', diffX, diffY);
                elm.style.transform = "translate3d(" + diffX + "px, " + diffY + "px, 0)";
            }
            document.addEventListener('mouseup', dragEnd);
            document.addEventListener('touchend', dragEnd);
            function dragEnd(endEvt) {
                console.log('dragEnd', endEvt);
                offsetX = (endEvt instanceof MouseEvent ? endEvt.clientX : endEvt.changedTouches[0].clientX) - initialPointX;
                offsetY = (endEvt instanceof MouseEvent ? endEvt.clientY : endEvt.changedTouches[0].clientY) - initialPointY;
                document.removeEventListener('mousemove', dragging);
                document.removeEventListener('touchmove', dragging);
                document.removeEventListener('mouseup', dragEnd);
                document.removeEventListener('touchend', dragEnd);
            }
        }
    }
  </script>
  <!--
  <script>
    var svgContainer = document.getElementById('svg-container');
    var svgDragee = document.getElementById('svg-dragee');
    var dragFuncs1 = new DragFuncs(svgDragee);
    svgDragee.addEventListener("touchstart", dragFuncs1.dragStart);
    document.addEventListener("touchend", dragFuncs1.dragEnd);
    document.addEventListener("touchmove", dragFuncs1.drag);

    svgDragee.addEventListener("mousedown", dragFuncs1.dragStart);
    document.addEventListener("mouseup", dragFuncs1.dragEnd);
    document.addEventListener("mousemove", dragFuncs1.drag);

    var dragItem = document.querySelector("#item");
    var dragFuncs2 = new DragFuncs(dragItem);
    var container = document.querySelector("#container");

    dragItem.addEventListener("touchstart", dragFuncs2.dragStart);
    document.addEventListener("touchend", dragFuncs2.dragEnd);
    document.addEventListener("touchmove", dragFuncs2.drag);

    dragItem.addEventListener("mousedown", dragFuncs2.dragStart);
    document.addEventListener("mouseup", dragFuncs2.dragEnd);
    document.addEventListener("mousemove", dragFuncs2.drag);

    function DragFuncs(dragItem) {
      this.initialX;
      this.initialY;
      this.active = false;
      this.xOffset = 0;
      this.yOffset = 0;

      this.dragStart = (e) => {
        console.log('dragStart at ', Date.now())
        if (e.type === "touchstart") {
          this.initialX = e.touches[0].clientX - this.xOffset;
          this.initialY = e.touches[0].clientY - this.yOffset;
        } else {
          this.initialX = e.clientX - this.xOffset;
          this.initialY = e.clientY - this.yOffset;
        }

        if (e.target === dragItem) {
          this.active = true;
        }
      }

      this.dragEnd = (e) => {
        console.log('dragEnd at ', Date.now())
        this.active = false;
      }

      this.drag = (e) => {
        console.log('drag at ', Date.now())
        if (this.active) {
          var currentX;
          var currentY;
          if (e.type === "touchmove") {
            currentX = e.touches[0].clientX - this.initialX;
            currentY = e.touches[0].clientY - this.initialY;
          } else {
          currentX = e.clientX - this.initialX;
          currentY = e.clientY - this.initialY;
          }

          this.xOffset = currentX;
          this.yOffset = currentY;

          setTranslate(currentX, currentY, dragItem);
        }
      }

      function setTranslate(xPos, yPos, el) {
        el.style.transform = "translate3d(" + xPos + "px, " + yPos + "px, 0)";
      }
    }
  </script>
  -->
</body>

</html>
